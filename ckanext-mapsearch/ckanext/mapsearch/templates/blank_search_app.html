{# a blank template (without the central (bootstrap) area)  #}
{% extends "base.html" %}
{% import 'macros/form.html' as form %}

{% block styles %}
    <link rel="stylesheet" type="text/css" href="/css/bootstrap.min.css" />
{% endblock %}

{% block links %}
    <link href="/filas_favicon.ico" rel="icon"/>
{% endblock %}

{% block scripts %}
    <script>
        bop = {};
        bop.result_nav = {};
        bop.filters = [];
        bop.num_filters_to_display = Number({{c.num_filters_to_display}}) || 12; // number of filterlinks to display (tags, formats, etc);
        bop.solr_url = '{{ c.solr_url }}';
        bop.query_on_load = true;
        bop.dataset_query_limit = 90;
        bop.results_per_page = 8;
        bop.max_num_of_pages = 10;
    </script>
    {% resource 'mapsearch_js/javascripts/vendor/jquery_ui_min.js' %}
    {% resource 'mapsearch_js/javascripts/mapsearch.js' %}
    {% resource 'mapsearch_js/javascripts/filters.js' %}
    {% resource 'mapsearch_js/javascripts/result_navigation.js' %}
    {% resource 'mapsearch_js/javascripts/search_results.js' %}
    {% resource 'mapsearch_js/javascripts/transport.js' %}
    {% resource 'mapsearch_js/css/style.css' %}
    {% resource 'mapsearch_js/css/jquery_ui_min.css' %}
    {% resource 'ckanext-spatial/spatial_query' %}
    {% resource 'mapsearch_js/javascripts/setup.js' %}
    {% resource 'mapsearch_js/javascripts/result_panel.js' %}
{% endblock %}

{% block page %}
    {% block search_app %}
        <div id="all">
          <div id="left_column">
            <div id="dataset-search" style="display:block"></div>
              <div class="left_panel" id="query_panel" style="display:block">
                <textarea id="keyword_search_input" rows="2" wrap="soft"></textarea>
                <button id="keyword_clear_button">clear</button>
                <button id="filter_toggler">filters</button>
                <a href="javascript:" id="filter_help_opener">filter help</a>
                <br/>
                <div id="navigation_links" style="display:none;">
                  <a href="javascript:" data-dir="previous" class="navigation_arrow" id="navigation_previous">&lt;-</a> 
                  <a href="javascript:" data-idx="1" class="navigation_number" id="nav_1" "style="display:none">1</a> 
                  <a href="javascript:" data-idx="2" class="navigation_number" id="nav_2" style="display:none">2</a> 
                  <a href="javascript:" data-idx="3" class="navigation_number" id="nav_3" style="display:none">3</a> 
                  <a href="javascript:" data-idx="4" class="navigation_number" id="nav_4" style="display:none">4</a> 
                  <a href="javascript:" data-idx="5" class="navigation_number" id="nav_5" style="display:none">5</a> 
                  <a href="javascript:" data-idx="6" class="navigation_number" id="nav_6" style="display:none">6</a> 
                  <a href="javascript:" data-idx="7" class="navigation_number" id="nav_7" style="display:none">7</a> 
                  <a href="javascript:" data-idx="8" class="navigation_number" id="nav_8" style="display:none">8</a> 
                  <a href="javascript:" data-dir="next" class="navigation_arrow" id="navigation_next">-></a>
                </div>
                <div id="filter_panel" class="left_panel" style="display:none;">
                  <div class="filter_group" id="organization_filter_container" title="organization filter" style="display:none;">
                    <a href="javascript:" class="filter_toggle" data-filter="" id="filter_toggle_proto" style="display:none;">org</a>
                  </div>
                  <div class="filter_group" id="groups_filter_container" title="groups filter" style="display:none;">
                  </div>
                  <div class="filter_group" id="tags_filter_container" title="tags filter">
                  </div>
                  <div class="filter_group" id="formats_filter_container" title="formats filter">
                  </div>
                  <div class="filter_group" id="license_filter_container" title="license filter">
                  </div>
                </div>
              </div>
              <div id="dataset-map-attribution">
              </div>
              {% snippet "snippets/result_panel.html" %}
              <div id="result_panel_container">
              </div>
          </div>
          <div id="right_column">
            {% set map_config = h.get_common_map_config() %}
            <div id='map_creator' class="dataset-map" data-module="mapsearch" data-default_extent="{{ default_extent }}" data-module-map_config="{{ h.dump_json(map_config) }}">
              <div id="map-container"></div>
            </div>
          </div>
        <div id="filter_help_window" style="display:none;">
          <h3>Filtering</h3>
          <p>
            you can use faceted search as explained <a href="http://lucene.apache.org/core/3_6_0/queryparsersyntax.html#Fields"><b>here.</b></a>
          </p>
          <p>
          In a nutshell it allows you to add facets to your query like this:<br/>
          </p>
          <p><code>title:water</code> - 
          will find datasets that have water in the title<br />
          </p>
          <p><code>title:water OR notes:respons*</code> -  will find the above datasets <b>plus</b> others that must have at least one word in their descriptions which starts with <i>respons.</i><br/><br />
          </p>
          available fields are:
          <table class="table">
            <tr>
              <thead>
                <th>fieldname</th><th>explanation</th><th>example</th>
              </thead>
            </tr>
            <tr>
              <td>title</td><td>title</td><td>title:Cilento</td>
            </tr>
            <tr>
              <td>notes</td><td>description</td><td>notes:environmental</td>
            </tr>
            <tr>
              <td>tags</td><td>tags</td><td>tags:"government-funded research"</td>
            </tr>
            <tr>
              <td>res_format</td><td>file format of contained resources</td><td>res_format:csv</td>
            </tr>
            <tr>
              <td>license_id</td>
              <td>License: see <b><a href="http://licenses.opendefinition.org/licenses/groups/ckan.json">here</a></b> for the default ids.<br/>
                <small>(this instance might only use a subset of those)</small>
              </td>
              <td>license_id:cc-by-sa</td>
            </tr>
            <tr>
              <td>text</td><td>catchall field for all text fields</td><td>text:tif</td>
            </tr>
          </table>
          <p>
          for improved usability there are helper links in the <b><a href="javascript:" onclick="$('#filter_panel').show();">filter panel</a></b> to easily assemble filters for <i>tags</i> and <i>formats</i>.
        </div>
        </div>
    {% endblock %}
{% endblock %}

